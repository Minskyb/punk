"use strict";!function(a){function b(b,c){this.$element=a(b),this.ratio=c}function c(){function c(c){a('[data-toggle="pk-ratio"]').each(function(){var c=a(this),d=c.data("pk-ratio"),e=parseFloat(c.attr("data-ratio"));return e?(d||c.data("pk-ratio",d=new b(this,e)),void d.resetHeight()):void console.error("data-ratio 系数未设置\n"+e)})}c(),a(window).resize(c)}b.prototype.resetHeight=function(){this.$element.css("height",this.$element.width()*this.ratio)},a.fn.Abox=c}(jQuery),function(){function a(){}$.fn.DExcute=a}(jQuery),function(a){function b(b,c){this.$element=a(b),this.initProperty(c),this.loadComponent(),this.setImage(),this.addEvent()}function c(c){return this.each(function(){var d=a(this),e=d.data("pk.imgClip");e?e.addEvent():d.data("pk.imgClip",e=new b(this,c))})}b.defaults={chosenWidth:100,chosenHeight:100,handle:!0},b.prototype.initProperty=function(c){this.setting=a.extend(!0,b.defaults,c?c:{})},b.prototype.loadComponent=function(){var b='<div class="pk-imgclip-mask"><div class="pk-imgclip-chosen"><img class="pk-imgclip-chosen-img"><div class="pk-chosen-border up"></div><div class="pk-chosen-border down"></div><div class="pk-chosen-border left"></div><div class="pk-chosen-border right"></div></div><div class="pk-imgclip-handle"><div class="pk-handle-border up"></div><div class="pk-handle-border down"></div><div class="pk-handle-border left"></div><div class="pk-handle-border right"></div><div class="pk-handle-box top-center"></div><div class="pk-handle-box top-left"></div><div class="pk-handle-box top-right"></div><div class="pk-handle-box bottom-center"></div><div class="pk-handle-box bottom-left"></div><div class="pk-handle-box bottom-right"></div><div class="pk-handle-box left-middle"></div><div class="pk-handle-box right-middle"></div></div></div>',c='<img class="pk-imgclip-origin">';this.$mask=a(b),this.$origin=a(c),this.$chosen=a(".pk-imgclip-chosen",this.$mask),this.$chosenImg=a(".pk-imgclip-chosen-img",this.$mask),this.$element.append(this.$mask),this.$element.append(this.$origin)},b.prototype.setImage=function(){this.$origin.attr("src",this.setting.originImg),a(".pk-imgclip-chosen-img").attr("src",this.setting.originImg)},b.prototype.addEvent=function(){this.$mask.on("mousedown",a.proxy(this.listenStartMove,this))},b.prototype.listenStartMove=function(b){b.stopPropagation(),b.preventDefault(),this.clientX=b.clientX,this.clientY=b.clientY,this.$mask.on("mousemove",a.proxy(this.handleMoving,this));var c=this;this.$mask.one("mouseup",function(){c.$mask.off("mousemove",a.proxy(c.handleMoving,c))})},b.prototype.handleMoving=function(a){a.stopPropagation(),a.preventDefault();var b=a.clientX-this.clientX,c=a.clientY-this.clientY;this.clientX=a.clientX,this.clientY=a.clientY,console.log("in handleMoving:("+b+","+c+")"),this.changeChosenPosition(b,c)},b.prototype.changeChosenPosition=function(a,b){var c=parseFloat(this.$mask.css("top").match(/[0-9]+(?=px)/)[0])||0,d=parseFloat(this.$mask.css("left").match(/[0-9]+(?=px)/)[0])||0;console.log("in changeChosenPosition:("+c+","+d+")"),this.$mask.css({top:c+b+"px",left:d+a+"px"}),this.$chosenImg.css({top:-c-b+"px",left:-d-a+"px"})},a.fn.ImgClip=c}(jQuery),function(a){function b(c,d){this.setting=a.extend(b.defaults,d),this.$element=a(c),this.addEvent()}function c(c){return this.each(function(){var d=a(this),e=d.data("limit-words");e?e.addEvent():d.data("limit-words",e=new b(this,c))})}b.defaults={limitLength:200},b.prototype.addEvent=function(){this.$element.on("keyup",a.proxy(this.chargeWordsNumber,this));var b=this;this.$element.one("focusout",function(){b.$element.off("keyup",a.proxy(b.chargeWordsNumber,b))})},b.prototype.chargeWordsNumber=function(a){for(var b=this.$element.val(),c=0,d=b.length,e=0;d>c;c++)if(e+=b.charCodeAt(c)>255?2:1,e>this.setting.limitLength)return e-=b.charCodeAt(c)>255?2:1,this.$element.next(".pk-input-add>.js-number").text(e),this.$element.val(b.slice(0,c));return this.$element.next(".pk-input-add").children(".js-number").text(e)},a.fn.LimitWords=c,a(document).ready(function(){a(document).on("click",'[data-toggle="limit-words"]',function(b){var d=a(b.target),e=parseInt(d.attr("data-limit"));c.call(d,{limitLength:e})})})}(jQuery),function(a){a(document).on("click",'[class*="pk-menu-item-content"]',function(b){var c=a(b.target);if(c.parent().toggleClass("toggle"),"menu"!=a(c.parent()).attr("data-toggle")){var d=c.parents(".pk-menu")[0];a(".pk-menu-item-content",d).removeClass("active"),c.addClass("active");var e=c.parents(".pk-menu-item");e&&e.children(".pk-menu-item-content").addClass("active")}})}(jQuery),function(a){function b(b,d){return this.each(function(){var e=a(this),f=e.data("pk.modal");f||e.data("pk.modal",f=new c(this,b)),"string"==typeof b?f[b](d):b.show&&f.show(d)})}var c=function(b,c){this.$body=a(document.body),this.$element=a(b),this.$dialog=this.$element.find(".pk-modal-dialog"),this.$backdrop=null,this.isShown=null};c.TRANSITION_DURATION=300,c.defualts={},c.prototype.show=function(b){var c=a.Event("show.pk.modal",{relatedTarget:b});if(this.$element.trigger(c),!this.isShown){this.isShown=!0;var d=this.measureScrollbar();this.$body.addClass("pk-modal-open"),this.hideScrollbar(d),this.backdrop(function(){})}},c.prototype.hide=function(a){this.$element.removeClass("in").off(".dismiss.pk.modal"),this.$backdrop.removeClass("in").off("dismiss.pk.modal"),this.isShown=!1,this.$element.hide(),this.$body.removeClass("pk-modal-open"),this.resetScrollbar(),this.removeBackdrop()},c.prototype.toggle=function(a){this.isShown?this.hide(a):this.show(a)},c.prototype.backdrop=function(b){var c=this;this.isShown&&(this.$backdrop=a(document.createElement("div")),this.$backdrop.addClass("pk-modal-backdrop fade").appendTo(this.$body),this.$element.on("click.dismiss.pk.modal",function(b){a(b.target).is(c.$element[0])&&c.hide()}),this.$backdrop.on("click",function(a){c.hide()}),this.$backdrop.addClass("in"),this.$element.show(0).addClass("in"))},c.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},c.prototype.hideScrollbar=function(a){this.originBodyPaddingRight=parseInt(this.$body.css("padding-right")||0,10),this.$body.css("padding-right",this.originBodyPaddingRight+a)},c.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originBodyPaddingRight)},c.prototype.measureScrollbar=function(){var a=document.createElement("div");a.className="pk-modal-measure-scrollbar",this.$body.append(a);var b=a.offsetWidth-a.clientWidth;return this.$body[0].removeChild(a),b},a.fn.modal=b,a(document.body).on("click.bt.modal.auto-init",'[data-toggle="modal"]',function(c){var d=a(this),e=d.attr("href"),f=a(d.attr("data-target")||e&&e.replace(/.*(?=#[^\s]+$)/,"")),g=f.data("pk.modal")?"toggle":a.extend({show:!0},f.data(),d.data());d.is("a")&&c.preventDefault(),b.call(f,g,this)})}(jQuery),function(a){function b(b){this.each(function(){var d=a(this),e=d.data("pk.slider");e||d.data("pk.slider",e=new c(this,b))})}var c=function(b,d){this.setting=a.extend(!0,c.defaults,d),this.$element=a(b),this.$content=a(".pk-content",this.$element),this.$page=a(".pk-page",this.$element),this.height=this.$element[0].clientHeight,this.width=this.$element[0].clientWidth,this.num=this.$page.length,this.index=0,this.initContent(),this.initNav();var e=window.navigator.userAgent.match(/MSIE\s(\d)/);e&&parseInt(e[1])<9&&(this.setting.ANIMATION=!1)};c.defaults={TRANSITION_DURATION:300,NAV:!0,ANIMATION:!0},c.prototype.initContent=function(){a(this.$page[0]).clone().appendTo(this.$content),a(this.$page[this.num-1]).clone().prependTo(this.$content),this.$page=a(".pk-page",this.$element),this.$page.css({width:this.width+"px"}),this.height||(this.height=this.$page[0].clientHeight),this.$element.css({height:this.height+"px"}),this.$page.css({height:this.height+"px"}),this.len=this.width*(this.num+2),this.$content.css({width:this.len+"px",left:-this.width+"px"})},c.prototype.initNav=function(){this.setting.NAV&&(this.$element.append('<div class="pk-slider-previous"></div><div class="pk-slider-next"></div>'),a(".pk-slider-next",this.$element).on("click",a.proxy(this.next,this)),a(".pk-slider-previous",this.$element).on("click",a.proxy(this.previous,this)))},c.prototype.next=function(b){if(!this.setting.ANIMATION)return void this.$content.append(a(".pk-page",this.$element)[0]);var c=this.$content[0].style.left.match(/-?\d+(?=px)/)[0],d=this;this.setLeft(parseInt(c)-d.width,d.setting.TRANSITION_DURATION,function(){d.index++,d.index==d.num&&(d.setLeft(-d.width,0),d.index=0)})},c.prototype.previous=function(b){if(!this.setting.ANIMATION)return void this.$content.prepend(a(".pk-page",this.$element)[this.num-1]);var c=this.$content[0].style.left.match(/-?\d+(?=px)/)[0],d=this;this.setLeft(parseInt(c)+d.width,d.setting.TRANSITION_DURATION,function(){d.index--,-1==d.index&&(d.setLeft(-d.width*d.num,0),d.index=d.num-1)})},c.prototype.setLeft=function(a,b,c){this.$content.animate({left:a+"px"},b,c)},a.fn.Slider=b}(jQuery);